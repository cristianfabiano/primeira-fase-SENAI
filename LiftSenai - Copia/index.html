<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

        <link rel="stylesheet" href="style.css">
</head>
<body>
    

<main class="card" role="main" aria-label="Formulário de cadastro LiftSenai">
    <h1>Cadastro LiftSenai</h1>
    <form id="formCadastro" autocomplete="off" novalidate>
      <input 
        type="text" 
        id="username" 
        name="username" 
        placeholder="Usuário" 
        minlength="3"
        aria-describedby="usernameHelp"
        required 
      />
      <input 
        type="password" 
        id="password" 
        name="password" 
        placeholder="Senha" 
        minlength="4"
        aria-describedby="passwordHelp"
        required 
      />
      <input 
        type="password" 
        id="passwordConfirm" 
        name="passwordConfirm" 
        placeholder="Confirme a senha" 
        minlength="4"
        required 
      />
      <button type="submit">Cadastrar</button>
    </form>
    <div id="msg" class="msg" role="alert" aria-live="polite"></div>
    <a href="login.html" tabindex="0">Já tem conta? Faça login</a>
  </main>

  <script>
    const form = document.getElementById('formCadastro');
    const msg = document.getElementById('msg');

    function getUsers() {
      try {
        const users = localStorage.getItem('users');
        return users ? JSON.parse(users) : [];
      } catch {
        return [];
      }
    }

    function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      msg.textContent = '';
      msg.className = 'msg'; // reset classes

      const username = form.username.value.trim();
      const password = form.password.value;
      const passwordConfirm = form.passwordConfirm.value;

      if (username.length < 3) {
        msg.textContent = 'Usuário precisa ter ao menos 3 caracteres.';
        msg.classList.add('error');
        form.username.focus();
        return;
      }

      if (password.length < 4) {
        msg.textContent = 'Senha precisa ter ao menos 4 caracteres.';
        msg.classList.add('error');
        form.password.focus();
        return;
      }

      if (password !== passwordConfirm) {
        msg.textContent = 'As senhas não conferem.';
        msg.classList.add('error');
        form.passwordConfirm.focus();
        return;
      }

      const users = getUsers();
      const userExists = users.some(u => u.username.toLowerCase() === username.toLowerCase());
      if (userExists) {
        msg.textContent = 'Usuário já existe.';
        msg.classList.add('error');
        form.username.focus();
        return;
      }

      users.push({ username, password });
      saveUsers(users);

      msg.textContent = 'Cadastro realizado com sucesso! Você será redirecionado para login...';
      msg.classList.add('success');

      form.reset();

      setTimeout(() => {
        window.location.href = 'login.html';
      }, 2000);
    });
    </script>
    <script src="script.js"></script>
    </body>
    </html>